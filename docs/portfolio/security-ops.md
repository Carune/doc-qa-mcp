# 보안 및 운영 노트

## 1. 보안 리스크

1. 경로 인덱싱 리스크
- `/api/index`는 서버에서 파일 경로를 직접 읽습니다.
- 외부 공개 시 민감 파일이 인덱싱될 수 있습니다.

2. 모델 가용성 리스크
- 로컬 Ollama 장애 시 답변 품질/지연이 흔들릴 수 있습니다.
- 폴백은 있으나 모니터링이 필요합니다.

3. 데이터 노출 리스크
- 인덱스 청크에 내부 기밀 정보가 포함될 수 있습니다.
- 실제 운영에는 접근제어와 소스 필터링이 필요합니다.

## 2. 현재 적용된 완화책

1. 근거 기반 답변 정책
- 생성 모델에 “제공된 컨텍스트만 사용”을 강제합니다.
- citation으로 추적 가능성을 확보했습니다.

2. 운영 폴백
- 모델 생성 실패 시, 결정적 citation 기반 응답으로 폴백합니다.

3. 저장소 분리
- 개발용 in-memory와 운영형 pgvector 경로를 분리했습니다.

## 3. 다음 하드닝 권장

1. 인덱싱 가능한 루트 경로 allowlist 적용
2. `/api/*` 인증 + rate limit 적용
3. 인입 문서 PII/secret 스캔 추가
4. 요청 ID 기반 구조 로그 및 실패 코드 정리
5. p95 latency, 모델 실패율 알림 추가

